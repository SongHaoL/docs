# NumPy 概述

- 2020.07.21

## 简介

> `NumPy` 是一个 `Python` 的第三方库，代表 `Numeric Python`，主要用于`数学/科学计算`。 它是一个由多维数组对象和用于处理数组的例程集合组成的库。

使用 `Numpy` 我们可以轻松进行如下等计算：

1. 数组的算数和逻辑运算。

2. 傅立叶变换和用于图形操作的例程。

3. 与线性代数有关的操作。 `NumPy` 拥有线性代数和随机数生成的内置函数。

## 安装

推荐使用`pip`命令进行安装或者下载 [Anaconda](https://www.anaconda.com/products/individual) (一个python集成环境应用，内置numpy等常用库)

```
pip install numpy
```

## 安装检查

我们可以引入`numpy`，如果未报错说明已经正常安装。

```py
# 这是约定俗称的引入方式
import numpy as np
```

## 开始

在开始前我们需要知道一个概念`ndarray`。`ndarray`是`Numpy`的核心功能,其含义为`n-dimenssional-array`，即`多维数组`。

:::tip
**数组与列表之间的主要区别为:**

- 数组是同类的,即数组的所以元素必须具有相同的类型。

- 列表可以包含任意其他类型的元素。

使用`Numpy`的函数可以快速的创建数组,效率比使用基本库更高,原因是内部使用的是`向量`。
:::

## 数组的创建

- 2020.07.21

> 数组由实际数据和描述这些数据的元素组成,可以使用`*.shape`查看数据的形状,也可以用`*.dim`查看数组的维数。

### 语法

``` py
import numpy as np

np.array(object, dtype = None, copy = True, order = None, subok = False, ndmin = 0)
```

### 参数说明

|  参数    |   描述    |
|:-------:|:----------|
| `object` |   任何暴露数组接口方法的对象都会返回一个数组或任何(嵌套)序列。  |
| `dtype` |   数组的所需数据类型，可选。  |
| `copy`  |   可选，默认为true，对象是否被复制。  |
| `order` |  C(按行)、F(按列)或A(任意，默认)。  |
| `subok` |   默认情况下，返回的数组被强制为基类数组。 如果为true，则返回子类。 |
| `ndimin` |   指定返回数组的最小维数。 |

### 数组创建

|  输入   |   输出    |  描述 
|:-------:|:----------|:----------|
| `np.array([1,2,3,4])` | `array([1,2,3,4])` | 创建一个一维数组 
| `np.array([[1,2,3],[4,5,6]], dtype=float)` | `array([[1. 2. 3.][4. 5. 6.]])` | 创建一个类型为float的二维数组
| `np.arange(0,3,1)` | `array([0 1 2])` | 创建一个从0开始到3结束(不包含3)步长为1的等差数列 
| `np.linspace(0,3,5)` | `array([0. 0.75 1.5 2.25 3.])` | 创建一个从0开始到3结束,总的元素为5个的等差数列,可以包含结束(常用于统计区间内指定不同范围的数据)
| `np.repeat([1,2,3],2)` | `array([1,1,2,2,3,3])` | 创建一个对已有数组元素值复制2次的新数组(对每个元素复制n次)
| `np.title([1,2,3],2)` | `array([1,2,3,1,2,3])` | 创建一个复制数组2次的新数组(对原数组复制n次)
| `np.empty([2,2], dtype = int)` | `array([[ 4611686018427387904 -5764598731833932082][7596498546853937154      562954583945058]])` | 创建了一个2行2列的数组,由于我们未给定初始化值,所以初始化出来的值是随机int8类型
| `np.ones((2,3))` | `array([[1. 1. 1.][1. 1. 1.]])` | 创建一个m行n列的单位矩阵
| `np.zeros((2,3))` | `array([[0. 0. 0.][0. 0. 0.]])` | 创建一个m行n列的0向量矩阵
| `np.random.random(3)` | `array([0.33540741 0.77770008 0.68126503])` | 创建一个0~1之间随机数的1行n列的数组
| `np.random.randn(3)` | `array([-1.89796613 -0.96672881  1.86899636])` | 创建一个1行n列的标准正态分布数组
| `np.random.normal(loc=0,scale=1,size=3)` | `array([-1.55783589  0.99025671  1.992423  ])` | 创建一个1行n列的均值为0,标准差为1的正态分布数组

### 数值类型补充

|  类型    |   描述    |
|:-------:|:----------|
| `bool` |  存储为一个字节的布尔值(True或False)。  |
| `int` |  默认整数，通常为int32或int64。  |
| `int8` |  字节（-128 ~ 127）。  |
| `int16` |  整数（-32768 ~ 32767）。  |
| `int32` |  整数（-2 ** 31 ~ 2 ** 31 - 1）。  |
| `int64` |  整数（-2 ** 63 ~ 2 ** 63 - 1）。  |
| `uint8` |  无符号整数（0 ~ 255）。  |
| `uint16` |  无符号整数（0 ~ 65535）。  |
| `uint32` |  无符号整数（0 ~ 2 ** 32 - 1）。  |
| `uint64` |  无符号整数（0 ~ 2 ** 64 - 1）。  |
| `float16` |  半精度浮点，符号位，5 位指数，10 位尾数。  |
| `float32` |  单精度浮点，符号位，8 位指数，23 位尾数。  |
| `float64或float` |  双精度浮点，符号位，11 位指数，52 位尾数。  |
| `complex64` |  复数，由两个 32 位浮点表示（实部和虚部）。  |
| `complex128或complex` |  复数，由两个 64 位浮点表示（实部和虚部）。  |

## 数组的索引与变换

> Python数组的索引与切片使用中括号 "[]" 选定下标来实现,同时采用 ":" 分割起始位置与间隔,用 ","表示不同的维度, 用 "..."表示遍历剩下的维度。使用`reshape()`函数可以重构数组。


|  输入   |   输出    |  描述 
|:-------:|:----------|:----------|
| `a = np.arange(6).reshape((3,2))` | `array([[0 1][2 3][4 5]])` | 创建了1个从0到6(不包含)的1行6列数组并且转置为3行2列的数组
| `a[:,1]` | `[1 3 5]` | 选取数组的第一列元素(逗号前面的表示行、逗号后面表示列)
| `a[:,[0,1]]` | `[[0 1][2 3][4 5]]` | 拷贝原数组并选取0到1列(返回的即是原数组的复制)
| `a[1,:]` | `[[2 3]]` | 选取数组的第二行 并且返回所有的列数
| `a[[0,1],:]` | `[[0 1][2 3]]` | 选取数组的第一行和第二行 并且返回所有的列数
| `a[1,1]` | `3` | 选取数组的第二行第二列所在的元素
| `a[a[:,1]>2,]` | `[[2 3][4 5]]` | `a[:,1]>2` 返回第一列数据与2的比较结果 `[False  True  True]` `a[[False  True  True],]` 返回第一行第二行对应的所有列的数组(即当对应行显示为True的时候返回该行)
| `a[a[:,1]>2,] & a[a[:,1]<4,]` | `[[2 3]]` | 多条件判断 返回上述结果元素小于4的情况下的数组
| `a.reshape(2,3)` | `[0 2 4][1 3 5]` | 将原来3行2列的数组转置为2行3列的数组
| `a.T` 或者 `np.transpose(a)` | `[0 2 4][1 3 5]` | 数组转置方法 行列转置
| `a.flatten()` | `[0 1 2 3 4 5]` | 将数组降为一维数组(返回原数组的拷贝)
| `a.ravel()` | `[0 1 2 3 4 5]` | 将数组降为一维数组(返回原数组的视图,改变了原数组)

:::tip
`Numpy`的`ravel()`和`flatten()`所实现的功能是一致的,都是将制定的多维数组降为一维数组。两者的区别是在于返回拷贝还是视图。

- `flatten()`返回原数组的拷贝,并不会改变原数组

- `ravel()`返回修改后的原数组,会影响原始的矩阵。
:::

## 数组的排序

- 2020.07.22

> `Numpy` 提供了多种排序函数,比如`sort`(直接返回排序后的数组)、`argsort`(返回数组排序后的下标)、`lexsort`(根据键值的字典序排序)、`msort`(沿着第一个轴排序)、`sort_complex`(对复数按照先实后虚的顺序排序)等。

```py
import numpy as np

# 一维数组a
a = np.array([3,2,5,4])

# 直接排序 [2,3,4,5]
np.sort(a)
a.sort()

# 降序排列 [5,4,3,2]
np.sort(np.argsort(-a))

# 数组排序后的下标 [1,0,3,2]
np.argsort(a)

# 二维数组
b = np.array([[1,4,3],[4,5,1],[2,3,2]])

# axis = 0 表示按列排序 axis = 1 表示按行排列
b.sort(axis=0)
```

## 数组的组合

- 2020.07.23

> 数组的组合可以分为: `水平组合(hstack)`、`垂直组合(vstack)`、`深度组合(dstack)`、`列组合(colume_stack)`、`行组合(row_stack)`等。


### np.concatenate((a1, a2, ...), axis)

> 沿指定轴连接相同形状的两个或多个数组,默认是沿着axis=0及列方向。

```py
import numpy as np

# [[0 1][2 3][4 5]]
a = np.arange(6).reshape(3,2)

# [[0 1 2][3 4 5][6 7 8]]
b = np.arange(9).reshape(3,3)

# [[0 1 2][3 4 5]]
c = np.arange(6).reshape(2,3)

'''
水平组合 
[[0 1 0 1 2]
 [2 3 3 4 5]
 [4 5 6 7 8]]
'''
np.hstack((a,b))
np.concatenate((a,b),axis=1)
np.append(a,b,axis=1)

'''
垂直组合
[[0 1 2]
 [3 4 5]
 [6 7 8]
 [0 1 2]
 [3 4 5]]
'''
np.vstack((b,c))
np.concatenate((b,c),axis=0)
np.append(b,c,axis=0)

'''
直接组合
[0 1 2 3 4 5 0 1 2 3 4 5]
'''
np.append(a,c)

```
## 数组的常用统计函数

- 2020.07.23

> 我们经常需要对数据进行一些统计处理,包括简单的均值、中值、方差、标准差、最大值、最小值等。

```py
import numpy as np

# [0 1 2 3 4 5]
a = np.arange(6)

# 统计平均值 2.5
np.mean(a)
np.average(a)

# 统计方差 2.9166666666666665
np.var(a)

# 统计标准差 1.707825127659933
np.std(a)

# 统计最大值 6
np.max(a)

# 统计最小值 0
np.min(a)

# 统计最大值所在的索引 6
np.argmax(a)

# 统计最小值所在的索引 0
np.argmin(a)

# 计算全距 即最大值与最小值的差 5
np.ptp(a)

# 计算百分位在统计对象中的值 4.5
np.percentile(a,90)

# 计算统计对象的中值 2.5
np.median(a)

# 计算统计对象的和 15
np.sum(a)
```

## 数组的分割

- 2020.07.24

> 在实际应用中我们经常需要在原有数据中提取部分数据或者进行分类分割,这时需要对原数组进行分割。

### np.split(ary, indices_or_sections, axis)

| 参数名  | 参数描述
| :--- | :---- 
| `ary` | 被分割的输入数组
| `indices_or_sections` | 可以是整数，表明要从输入数组创建的，等大小的子数组的数量。  如果此参数是一维数组，则其元素表明要创建新子数组的点。
| `axis` | 分割的方向默认是沿0轴

```py
import numpy as np
a = np.arange(9)

# [0 1 2 3 4 5 6 7 8]
print('第一个数组：')
print(a,'\n')

# [array([0, 1, 2]), array([3, 4, 5]), array([6, 7, 8])]
print('将数组分为三个大小相等的子数组：')
b = np.split(a,3)
print(b,'\n')

# [array([0, 1, 2, 3]), array([4, 5, 6]), array([7, 8])]
print('将数组在一维数组中指定的位置分割：')
b = np.split(a,[4,7])
print(b)
```

### np.hsplit(ary, indices_or_sections)

> `np.hsplit`是`split()`函数的特例，其中轴为 1 表示水平分割，无论输入数组的维度是什么。

```py
import numpy as np
a = np.arange(16).reshape(4,4)

print('第一个数组：')
print(a,'\n')

'''
[[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]
 [12 13 14 15]]
'''

print('水平分割后：')
b = np.hsplit(a,2)
print(b)

'''
[array([[ 0,  1],
        [ 4,  5],
        [ 8,  9],
        [12, 13]]), 
 array([[ 2,  3],
        [ 6,  7],
        [10, 11],
        [14, 15]])]
'''

```
### np.vsplit(ary, indices_or_sections)

> `np.vsplit`是`split()`函数的特例，其中轴为 0 表示竖直分割，无论输入数组的维度是什么。

```py
import numpy as np
a = np.arange(16).reshape(4,4)

print('第一个数组：')
print(a,'\n')

'''
[[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]
 [12 13 14 15]]
'''

print('垂直分割后：')
b = np.vsplit(a,2)
print(b)

'''
[array([[0, 1, 2, 3],
       [4, 5, 6, 7]]), 
 array([[ 8,  9, 10, 11],
       [12, 13, 14, 15]])]
'''
```