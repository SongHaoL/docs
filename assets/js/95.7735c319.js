(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{714:function(t,s,a){"use strict";a.r(s);var n=a(15),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"try-catch语句"}},[t._v("try-catch语句")]),t._v(" "),a("p",[t._v("try-catch常用于兼容性写法。")]),t._v(" "),a("h2",{attrs:{id:"在try-catch语句中-使用try时进行return操作-finally语句会执行么"}},[t._v("在try-catch语句中,使用try时进行return操作,finally语句会执行么?")]),t._v(" "),a("ul",[a("li",[t._v("2020.11.9")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'finally'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// finally return 0;")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("上述代码执行结果是"),a("code",[t._v("finally")]),t._v("确实执行了,而且"),a("code",[t._v("return")]),t._v("语句也生效了,函数返回了0；")]),t._v(" "),a("p",[t._v("但是虽然return语句执行了,函数并没有立即返回,又执行了finally里面的内容,这样的行为违背了很多人的直觉。")]),t._v(" "),a("p",[t._v("假如将"),a("code",[t._v("finally")]),t._v("中的代码也返回"),a("code",[t._v("return")]),t._v(",那么执行结果将会是什么?")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'finally'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// finally ")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("上述代码的执行结果是: "),a("code",[t._v("finally")]),t._v("中的"),a("code",[t._v("return")]),t._v("覆盖了 "),a("code",[t._v("try")]),t._v("中的 "),a("code",[t._v("return")]),t._v("。在一个函数中执行了两次return,这已经超出了很多人的常识,也是其他语言中不会出现的一种行为。")]),t._v(" "),a("p",[t._v("产生上述执行结果的实质原因是背后运行的"),a("code",[t._v("Completion Record")]),t._v("机制。")]),t._v(" "),a("h3",{attrs:{id:"completion-record机制"}},[t._v("Completion Record机制")]),t._v(" "),a("p",[t._v("表示一个语句执行完成之后的结果,它有3个字段:")]),t._v(" "),a("ol",[a("li",[a("p",[a("code",[t._v("type:")]),t._v(" 表示完成的类型,有"),a("code",[t._v("break")]),t._v("、"),a("code",[t._v("continue")]),t._v("、"),a("code",[t._v("return")]),t._v("、"),a("code",[t._v("throw")]),t._v("和"),a("code",[t._v("normal")]),t._v("几种类型。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("value:")]),t._v(" 表示语句的返回值,如果语句没有返回值,则是"),a("code",[t._v("empty")]),t._v("。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("target:")]),t._v(" 表示语句的目标,通常是一个javascript标签。")])])]),t._v(" "),a("p",[a("code",[t._v("Javascript")]),t._v("正是依靠语句的"),a("code",[t._v("Completion Record类型")]),t._v("才可以在语句的复杂嵌套结构中,实现各种控制。")]),t._v(" "),a("p",[t._v("理解这块内容之前先来看看语句的分类:")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201109112733669.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3hqbDI3MTMxNA==,size_16,color_FFFFFF,t_70#pic_center",alt:"语句分类"}})]),t._v(" "),a("h4",{attrs:{id:"普通语句"}},[t._v("普通语句")]),t._v(" "),a("p",[t._v("这些语句在执行时,从前到后顺次执行,没有任何分支或者重复执行逻辑。")]),t._v(" "),a("p",[t._v("普通语句执行完成后,会得到"),a("code",[t._v("type")]),t._v("为"),a("code",[t._v("normal")]),t._v("的"),a("code",[t._v("Completion Record")]),t._v(", javascript引擎遇到这样的记录就会执行下一条语句。")]),t._v(" "),a("p",[t._v("这些语句中只有"),a("code",[t._v("表达式语句")]),t._v("会产生value,从引擎的角度,这个value并没有什么用处,这就像我们在Chrome的控制台调式工具中输入一个表达式是可以得到结果的,但是在表达式前面加上var,就变成了"),a("code",[t._v("undefined")]),t._v("。这也说明了Chrome控制台输出的是语句的"),a("code",[t._v("Completion Record")]),t._v("的value值。")]),t._v(" "),a("h4",{attrs:{id:"语句块"}},[t._v("语句块")]),t._v(" "),a("p",[t._v("语句块就是拿大括号括起来的一组语句,它是一种语句的复合结构,可以嵌套。")]),t._v(" "),a("p",[t._v("在使用语句块的时候,我们需要注意的是语句块内部的"),a("code",[t._v("Completion Record")]),t._v("type如果不是normal的话,就会打断语句块后续的执行。")]),t._v(" "),a("h4",{attrs:{id:"控制型语句"}},[t._v("控制型语句")]),t._v(" "),a("p",[t._v("控制型语句带有if、switch关键字,它们会对不同类型的"),a("code",[t._v("Completion Record")]),t._v("产生反应。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201109135343908.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3hqbDI3MTMxNA==,size_16,color_FFFFFF,t_70#pic_center",alt:"控制型语句"}})]),t._v(" "),a("p",[t._v("通过这个表我们发现,因为finally中的内容必须保证执行,所以try/catch执行完毕,即使得到的结果是非normal类型的完成记录,也必须要执行finally。")]),t._v(" "),a("p",[t._v("而当finally执行也得到了了非normal的记录,则会是finally中的记录作为整个try结构的结果。")]),t._v(" "),a("h4",{attrs:{id:"带标签的语句"}},[t._v("带标签的语句")]),t._v(" "),a("p",[t._v("前文阐述了一些type在语句中的作用,接下来涉及到target。")]),t._v(" "),a("p",[t._v("实际上,任何javascript语句是可以加标签的,在语句前面加冒号即可:")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("firstStatement"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("大部分的时候,这个东西类似于注释,没有任何作用。唯一有作用的时候是: 与完成记录类型中的target相配合,用于跳出多层循环。")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("outer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    inner"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),t._v(" outer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'finished'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("break/continue 语句如果后跟了关键字,会产生带target的完成记录。一旦完成记录带了target,那么只有拥有对应label的循环语句会消费它。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("总结:")]),t._v(" "),a("p",[t._v("因为"),a("code",[t._v("Javascript")]),t._v("语句存在嵌套关系,所以只需过程实际上主要在一个树形结构上进行,树形结构的每一个节点执行后产生"),a("code",[t._v("Completion Record")]),t._v(",根据语句的结构和"),a("code",[t._v("Completion Record")]),t._v(","),a("code",[t._v("Javascript")]),t._v("实现了各种分支合跳出逻辑。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);