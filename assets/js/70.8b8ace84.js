(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{731:function(t,s,e){"use strict";e.r(s);var a=e(14),v=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"html5-脚本编程"}},[t._v("HTML5 脚本编程")]),t._v(" "),e("h2",{attrs:{id:"跨文档消息传递"}},[t._v("跨文档消息传递")]),t._v(" "),e("p",[e("strong",[t._v("跨文档消息传送（cross-document messaging）")]),t._v("，有时候简称为 "),e("code",[t._v("XDM")]),t._v("，"),e("strong",[t._v("指的是在来自不同域的页面间传递消息。")])]),t._v(" "),e("blockquote",[e("p",[t._v("例如，"),e("code",[t._v("www.wrox.com")]),t._v("域中的页面与位于一个内嵌框架中的 "),e("code",[t._v("p2p.wrox.com")]),t._v(" 域中的页面通信。")])]),t._v(" "),e("p",[t._v("在 "),e("code",[t._v("XDM")]),t._v(" 机制出现之前，要稳妥地实现这种通信需要花很多工夫。"),e("code",[t._v("XDM")]),t._v(" 把这种机制规范化，让我们能既稳妥又简单地实现跨文档通信。")]),t._v(" "),e("p",[e("code",[t._v("XDM")]),t._v("的核心是 "),e("code",[t._v("postMessage()")]),t._v("方法。在 "),e("code",[t._v("HTML5")]),t._v(" 规范中，除了 "),e("code",[t._v("XDM")]),t._v(" 部分之外的其他部分也会提到这个方法名，但都是为了同一个目的：**向另一个地方传递数据。"),e("strong",[t._v("对于 "),e("code",[t._v("XDM")]),t._v(" 而言，")]),t._v("“另一个地方”指的是包含在当前页面中的"),e("code",[t._v("<iframe>")]),t._v("元素，或者由当前页面弹出的窗口。\n**")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[e("code",[t._v("postMessage()")]),t._v("方法接收两个参数："),e("code",[t._v("一条消息")]),t._v("和"),e("code",[t._v("一个表示消息接收方来自哪个域的字符串")]),t._v("。第二个参数对保障安全通信非常重要，可以防止浏览器把消息发送到不安全的地方。来看下面的例子。")])]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意：所有支持 XDM 的浏览器也支持 iframe 的 contentWindow 属性")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" iframeWindow "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myframe"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("contentWindow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \niframeWindow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A secret"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://www.wrox.com"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("接收到 "),e("code",[t._v("XDM")]),t._v("消息时，会触发 "),e("code",[t._v("window")]),t._v("对象的 "),e("code",[t._v("message")]),t._v("事件。")]),t._v(" "),e("p",[t._v("这个事件是以异步形式触发的，因此从发送消息到接收消息（触发接收窗口的 "),e("code",[t._v("message")]),t._v(" 事件）可能要经过一段时间的延迟。触发 "),e("code",[t._v("message")]),t._v("事件后，传递给 "),e("code",[t._v("onmessage")]),t._v(" 处理程序的事件对象包含以下三方面的重要信息。")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("data")]),t._v("：作为"),e("code",[t._v("postMessage()")]),t._v("第一个参数传入的字符串数据。")]),t._v(" "),e("li",[e("code",[t._v("origin")]),t._v('：发送消息的文档所在的域，例如"http://www.wrox.com"。')]),t._v(" "),e("li",[e("code",[t._v("source")]),t._v("：发送消息的文档的 "),e("code",[t._v("window")]),t._v(" 对象的代理。这个代理对象主要用于在发送上一条消息的窗口中调用 "),e("code",[t._v("postMessage()")]),t._v("方法。如果发送消息的窗口来自同一个域，那这个对象就是"),e("code",[t._v("window")]),t._v("。")])]),t._v(" "),e("h2",{attrs:{id:"原生拖放"}},[t._v("原生拖放")])])}),[],!1,null,null,null);s.default=v.exports}}]);